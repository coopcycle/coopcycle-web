include:
  - stores_excl_setup.yml
  - user_dispatcher.yml
  - restaurants.yml

AppBundle\Entity\User:
  courier_{1..50}:
    __factory:
      '@Nucleos\UserBundle\Util\UserManipulator::create':
        - '<username()>'
        - '12345678'
        - '<email()>'
        - true
        - false
    roles: [ 'ROLE_COURIER' ]
    telephone: <identity(\libphonenumber\PhoneNumberUtil::getInstance()->parse('+33612345678'))>

AppBundle\Entity\Task:
  task_1:
    address: "@address_1"
    doneAfter: <identity(new \DateTime('today 10:30:00'))>
    doneBefore: <identity(new \DateTime('today 11:00:00'))>
  task_2:
    address: "@address_2"
    doneAfter: <identity(new \DateTime('today 11:30:00'))>
    doneBefore: <identity(new \DateTime('today 12:00:00'))>

AppBundle\Entity\Delivery:
  delivery_{1..5}:
    __factory:
      createWithTasks:
        - '@task_1'
        - '@task_2'
    __calls:
      - setOrder:
          - '@order_<current()>'
      - setPickupRange:
          - <identity(new \DateTime('today 18:00:00'))>
          - <identity(new \DateTime('today 18:30:00'))>
      - setDropoffRange:
          - <identity(new \DateTime('today 19:00:00'))>
          - <identity(new \DateTime('today 19:30:00'))>
    store: "@store_1"

AppBundle\Entity\Sylius\Order:
  order_{1..5}:
    __factory:
      '@sylius.factory.order::createForRestaurant':
        - "@pizza_express"
    __calls:
      #      FIXME: that does not set an order number on each task (normally it's handled by OrderSubscriber)
      - setNumber: [ "ORDER <current()>" ]
      - setState: [ 'new' ]
