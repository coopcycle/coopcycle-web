AppBundle\Entity\Task:
  task_1:
    address: "@address_warehouse"
    doneAfter: <identity(new \DateTime('today 18:00:00'))>
    doneBefore: <identity(new \DateTime('today 18:30:00'))>
  task_2:
    address: "@address_client_1"
    doneAfter: <identity(new \DateTime('today 19:00:00'))>
    doneBefore: <identity(new \DateTime('today 19:30:00'))>

AppBundle\Entity\Delivery:
  delivery_1:
    __factory:
      createWithTasks:
        - '@task_1'
        - '@task_2'
    store: "@store_1"

AppBundle\Entity\Sylius\Order:
  order_1:
    __factory:
      '@sylius.factory.order::createForDelivery':
        - "@delivery_1"
    __calls:
      # FIXME: this does not set an order number on each task (normally it's handled by OrderSubscriber)
      # but doing so inside DeliveryOrderProcessor (via OrderManager.onDemand) is too slow
      - setNumber: [ "A1" ]
      - setState: [ 'new' ]
    # The rest of initialization is done by DeliveryOrderProcessor
